name: Assign and Move Issue on Branch Creation

on:
  create:
    types:
      - branch

jobs:
  assign_and_move_issue:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v2

      - name: Get issue associated with branch
        id: get_issue
        run: |
          BRANCH_NAME="${{ github.ref }}"
          ISSUE_NUMBER=$(echo $BRANCH_NAME | sed 's/\//-/g') # Assuming branch name is in the format issue/123
          echo "::set-output name=issue_number::$ISSUE_NUMBER"

      - name: Update issue status and assignee
        uses: actions/github-script@v5
        with:
          github-token: ${{ secrets.GITHUB_TOKEN }}
          script: |
            const issueNumber = process.env.ISSUE_NUMBER;
            const assignee = context.actor;
            
            // Update issue status to "In Progress"
            await github.rest.issues.update({
              owner: context.repo.owner,
              repo: context.repo.repo,
              issue_number: issueNumber,
              state: 'open'
            });

            // Add "In Progress" label
            await github.rest.issues.addLabels({
              owner: context.repo.owner,
              repo: context.repo.repo,
              issue_number: issueNumber,
              labels: ['In Progress'] // Replace with your desired label name
            });

            // Assign the branch creator to the issue
            await github.rest.issues.update({
              owner: context.repo.owner,
              repo: context.repo.repo,
              issue_number: issueNumber,
              assignees: [assignee]
            });
            
